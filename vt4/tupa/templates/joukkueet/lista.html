{% extends "joukkueet/base.html" %}
{% block title %}Listaa{% endblock %}
{% block content %}

<h1>Kilpailun sarjat ja joukkueet:</h1>

{% if kilpailut | length == 0 %}
<p class="bold large error">Ei kilpailuja!</p>
{% else %}
<ul>
    {% for kilpailu_id, kilpailu in kilpailut.items() %}
    <li class='bold large'>{{kilpailu['nimi']}}</li>
        <ul>
            {% for sarja_id, sarja in kilpailu['sarjat'].items() %}
            <li class='bold large'>{{sarja['nimi']}}</li>
                <ul>
                {% for joukkue_id, joukkue in sarja['joukkueet'].items() %}
                    {% if joukkue['saa_muokata'] %}
                    <li class='large'><a href="{{url_for('joukkueet.muokkaa', id=joukkue_id, sarja=sarja_id, kilpailu=kilpailu_id)}}">{{joukkue['nimi']}}</a></li>
                    {% else %}
                    <li class='large'>{{joukkue['nimi']}}</li>
                    {% endif %}
                        <ul>
                            <li>Jäsenet</li>
                                <ul>
                                    {% for jasen in joukkue['jasenet'] %}
                                    <li>{{jasen}}</li>
                                    {% endfor %}
                                </ul>
                            <li>Leimaukset</li>
                                <ul>
                                    {% if 'admin' in roles and ((valittu_kilpailu | int) == kilpailu_id) %}
                                    <li><a href="{{url_for('leimaukset.lisaa', joukkue=joukkue_id, sarja=sarja_id, kilpailu=kilpailu_id)}}">Lisää uusi leimaus</a></li>
                                    {% endif %}
                                    {% for leimaus_id, leimaus in joukkue['leimaukset'].items() %}
                                        {% if 'admin' in roles and (valittu_kilpailu | int) == kilpailu_id %}
                                        <li><a href="{{url_for('leimaukset.muokkaa', id=leimaus_id, joukkue=joukkue_id, sarja=sarja_id, kilpailu=kilpailu_id)}}">{{hae_koodi(kilpailu_id, leimaus_id)}}: {{leimaus}}</a></li>
                                        {% else %}
                                        <li>{{hae_koodi(kilpailu_id, leimaus_id)}}: {{leimaus}}</li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                    </ul>
                {% endfor %}
                </ul>
            {% endfor %}
        </ul>
        {% if kilpailu['rastit'] | length > 0 %}
        <ul>
            <li class='bold large'>Rastit:</li>
            <ul>
                {% for rasti_id, rasti in kilpailu['rastit'].items() %}
                {% if rasti['saa_muokata'] %}
                <li class='bold'><a href="{{url_for('rastit.muokkaa', id=rasti_id, kilpailu=kilpailu_id)}}">{{rasti['koodi']}}</a></li>
                {% else %}
                <li class='bold'>{{rasti['koodi']}}</li>
                {% endif %}
                <ul>
                    <li>lat: {{rasti['lat']}}</li>
                    <li>lon: {{rasti['lon']}}</li>
                </ul>
                {% endfor %}
            </ul>
        </ul>
        {% endif %}
    {% endfor %}
</ul>
{% endif %}

{% endblock %}